if (DISABLE_REAL_STAKE)
    add_definitions(-DXENABLE_MOCK_ZEC_STAKE)
endif()

aux_source_directory(./src src)
add_library(xchaininit ${src})

if (BUILD_GPERF)
    target_link_libraries(xchaininit PRIVATE tcmalloc_and_profiler)
elseif (BUILD_GHPERF)
    target_link_libraries(xchaininit PRIVATE tcmalloc_and_profiler)
elseif(TCMALLOC)
    target_link_libraries(xchaininit PRIVATE tcmalloc_minimal)
endif()

find_library(jsoncpp_LIBRARIES libjsoncpp.a HINTS ${LIBRARY_OUTPUT_DIRECTORY} REQUIRED)
find_library(secp256k1_LIBRARY libsecp256k1.a REQUIRED)

target_link_libraries(
    xchaininit
    PRIVATE
    xapplication
    xmigrate
    xconfig
    xloader
    xdata
    xvnode
    xstore
    xrpc
    xelect
    xtopcl
    xrouter
    xvnetwork
    db_tool
    xxbase
    xhttp
    xbasic
    ${jsoncpp_LIBRARIES}
    ${secp256k1_LIBRARY}
    trezor-crypto
    pthread
    dl
)

if (LEAK_TRACER)
    target_link_libraries(xchaininit PRIVATE leaktracer)
endif()

if (BUILD_GPERF)
    target_link_libraries(xchaininit PRIVATE profiler)
endif()
